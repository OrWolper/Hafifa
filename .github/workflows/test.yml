name: Issue created

on:
  issues:
    types: [opened, reopened]
  workflow_dispatch:
          # EXTERNAL_KEY="external-hatch-${PROJECT_NAME}"
          # INTERNAL_KEY="internal-hatch-${PROJECT_NAME}"
jobs:
  create-subscription-key:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Get subscription info
        run: |
          PROJECT_NAME=$(echo "${{ github.event.issue.body }}" | awk 'NR == 3')
          EXTERNAL_CHECKBOX=$(echo "${{ github.event.issue.body }}" | awk 'NR == 7 {print substr($0, 3, 3)}')
          INTERNAL_CHECKBOX=$(echo "${{ github.event.issue.body }}" | awk 'NR == 8 {print substr($0, 3, 3)}')
          EXTERNAL_KEY="None"
          INTERNAL_KEY="None"
          if [[ $EXTERNAL_CHECKBOX == "[X]"]]; then
            echo "external"
          if [[ $INTERNAL_CHECKBOX == "[X]"]]; then
            echo "internal"
          echo "$PROJECT_NAME"
          echo "$EXTERNAL_KEY"
          echo "$INTERNAL_KEY"
